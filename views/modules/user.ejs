<script type="text/ng-template" id="/user.html">
    <div ui-view></div>
</script>

<script type="text/ng-template" id="/user.register.html">
    <div class="row">
        <div class="col-sm-offset-2 col-sm-8">
            <form ng-submit="submit()"  class="form-horizontal">
                <div class="form-group row ng-class: user.email.classes.group;">
                    <label for="email" class="col-sm-2 control-label">Email</label>
                    <div class="col-sm-10 col-lg-6">
                        <input
                            ng-model="user.email.value"
                            ng-change="validate.email();"

                            type="email"
                            class="form-control "
                            id="email"
                            placeholder="Email">
                        <span ng-show="user.email.success" class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true"></span>
                    </div>
                </div>
                <div ng-if="admin.requireEmailConfirmation" class="form-group row ng-class: user.emailConfirmation.classes.group;">
                    <label for="email" class="col-sm-2 control-label">Code</label>
                    <div class="col-sm-10 col-lg-6">
                        <div class="input-group">
                            <div ng-if="admin.requireEmailConfirmation" class="input-group-btn">
                                <button type="button" class="btn btn-primary" ng-disabled="!user.email.success">Send</button>
                            </div>
                            <input
                                ng-model="user.emailConfirmation.value"
                                ng-change="validate.emailConfirmation();"

                                type="text"
                                class="form-control form-control-success"
                                id="emailConfirmation"
                                placeholder="Email Confirmation Code"
                                autocomplete="false">
                            <span ng-show="user.emailConfirmation.success" class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true"></span>
                        </div>
                    </div>
                </div>
                <div class="form-group row ng-class: user.password.classes.group;">
                    <label for="password" class="col-sm-2 control-label">Password</label>
                    <div class="col-sm-10 col-lg-6">
                        <input
                            ng-model="user.password.value"
                            ng-change="validate.password(); validate.passwordConfirm();"

                            type="password"
                            class="form-control form-control-success"
                            id="password"
                            placeholder="Password">
                        <span ng-show="user.password.success" class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true"></span>

                        <h6>Password Strength:<b> {{user.password.testResult.strength}} / 4</b></h6>

                        <h6>Time to Crack:<b> {{user.password.testResult.crackTime}}</b></h6>

                        <div ng-if="user.password.testResult.warnings.length > 0" class="alert alert-danger" role="alert">
                            <h6 ng-repeat="pw_error in user.password.testResult.warnings">
                                <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                                <span class="sr-only">Suggestion:</span>
                                {{pw_error}}
                            </h6>
                        </div>
                    </div>
                </div>
                <div class="form-group row ng-class: user.passwordConfirm.classes.group;">
                    <label for="password" class="col-sm-2 control-label">Re-enter Password</label>
                    <div class="col-sm-10 col-lg-6">
                        <input
                            ng-model="user.passwordConfirm.value"
                            ng-change="validate.passwordConfirm();"

                            type="password"
                            class="form-control form-control-success"
                            id="passwordConfirm"
                            placeholder="Re-enter Password">
                        <span ng-show="user.passwordConfirm.success" class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true"></span>
                    </div>
                </div>
                <div ng-if="admin.requireAgreement" class="form-group row">
                    <div class="col-sm-offset-2 col-sm-10 col-lg-6">
                        <div class="checkbox">
                            <label class="control-label">
                                <input ng-model='user.agreeToTaC' type="checkbox">
                                Agree to
                            </label>
                            <a href="{{admin.termsAndConditions}}">terms and conditions</a>.
                        </div>
                    </div>
                </div>
                <div ng-if="admin.enablePasswordReset" class="form-group row">
                    <div class="col-sm-offset-2 col-sm-10 col-lg-6">
                        <div class="checkbox">
                            <label class="control-label">
                                <input ng-model='user.enablePasswordReset' type="checkbox">
                                Enable Emailed Password Resets
                            </label>
                        </div>
                        <div ng-if="user.enablePasswordReset" class="alert alert-danger" role="alert">
                            <h6>
                                <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                                Allowing your password to be reset by email is discouraged since email communication
                                is not secure, and could allow un-authorized access to your account.
                                However, without this enabled your password cannot be reset if you forget it.
                            </h6>
                        </div>
                    </div>
                </div>
                <div class="form-group row">
                    <div class="col-sm-offset-2 col-sm-10 col-lg-6">
                        <button type="submit" class="btn btn-primary" ng-disabled="!allowRegister()">Register</button>
                    </div>
                </div>
                <div ng-if='error' class="form-group row">
                    <div class="col-sm-offset-2 col-sm-10 col-lg-6">
                        <div ng-include="'/common.error.html'" ng-controller="common.error" onload="init(error)"><div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</script>


<script type="text/ng-template" id="/user.login.html">
    <div class="row">
        <div class="col-sm-offset-2 col-sm-8">
            <form ng-submit="submit()"  class="form-horizontal">
                <div class="form-group row">
                    <label for="email" class="col-sm-2 control-label">Email</label>
                    <div class="col-sm-10 col-lg-6">
                        <input
                            ng-model="user.email"

                            type="email"
                            class="form-control "
                            id="email"
                            placeholder="Email">
                    </div>
                </div>
                <div class="form-group row">
                    <label for="password" class="col-sm-2 control-label">Password</label>
                    <div class="col-sm-10 col-lg-6">
                        <input
                            ng-model="user.password"

                            type="password"
                            class="form-control form-control-success"
                            id="password"
                            placeholder="Password">
                    </div>
                </div>


                <div class="form-group row">
                    <div class="col-sm-offset-2 col-sm-10 col-lg-6">
                        <div class="checkbox">
                            <label class="control-label">
                                <input ng-model='user.rememberLogin' type="checkbox">
                                Remember Login
                            </label>
                        </div>
                    </div>
                </div>
                <div class="form-group row">
                    <div class="col-sm-offset-2 col-sm-10 col-lg-6">
                        <button type="submit" class="btn btn-primary">Login</button>
                    </div>
                </div>
                <div ng-if='error' class="form-group row">
                    <div class="col-sm-offset-2 col-sm-10 col-lg-6">
                        <div ng-include="'/common.error.html'" ng-controller="common.error"><div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</script>


<script type="text/ng-template" id="/user.reset.html">
    <div class="row">
        <div class="col-sm-offset-2 col-sm-8">
            <form ng-submit="submit()"  class="form-horizontal">
                <div class="form-group row ng-class: user.email.classes.group;">
                    <label for="email" class="col-sm-2 control-label">Email</label>
                    <div class="col-sm-10 col-lg-6">
                        <input
                            ng-model="user.email.value"
                            ng-change="validate.email();"

                            type="email"
                            class="form-control "
                            id="email"
                            placeholder="Email">
                        <span ng-show="user.email.success" class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true"></span>
                    </div>
                </div>
                <div ng-if="admin.requireEmailConfirmation" class="form-group row ng-class: user.emailConfirmation.classes.group;">
                    <label for="email" class="col-sm-2 control-label">Code</label>
                    <div class="col-sm-10 col-lg-6">
                        <div class="input-group">
                            <div ng-if="admin.requireEmailConfirmation" class="input-group-btn">
                                <button type="button" class="btn btn-primary" ng-disabled="!user.email.success">Send</button>
                            </div>
                            <input
                                ng-model="user.emailConfirmation.value"
                                ng-change="validate.emailConfirmation();"

                                type="text"
                                class="form-control form-control-success"
                                id="emailConfirmation"
                                placeholder="Email Confirmation Code"
                                autocomplete="false">
                            <span ng-show="user.emailConfirmation.success" class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true"></span>
                        </div>
                    </div>
                </div>
                <div class="form-group row ng-class: user.password.classes.group;">
                    <label for="password" class="col-sm-2 control-label">Password</label>
                    <div class="col-sm-10 col-lg-6">
                        <input
                            ng-model="user.password.value"
                            ng-change="validate.password(); validate.passwordConfirm();"

                            type="password"
                            class="form-control form-control-success"
                            id="password"
                            placeholder="Password">
                        <span ng-show="user.password.success" class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true"></span>

                        <h6>Password Strength:<b> {{user.password.testResult.strength}} / 4</b></h6>

                        <h6>Time to Crack:<b> {{user.password.testResult.crackTime}}</b></h6>

                        <div ng-if="user.password.testResult.warnings.length > 0" class="alert alert-danger" role="alert">
                            <h6 ng-repeat="pw_error in user.password.testResult.warnings">
                                <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                                {{pw_error}}
                            </h6>
                        </div>
                    </div>
                </div>
                <div class="form-group row ng-class: user.passwordConfirm.classes.group;">
                    <label for="password" class="col-sm-2 control-label">Re-enter Password</label>
                    <div class="col-sm-10 col-lg-6">
                        <input
                            ng-model="user.passwordConfirm.value"
                            ng-change="validate.passwordConfirm();"

                            type="password"
                            class="form-control form-control-success"
                            id="passwordConfirm"
                            placeholder="Re-enter Password">
                        <span ng-show="user.passwordConfirm.success" class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true"></span>
                    </div>
                </div>
                <div ng-if="admin.requireAgreement" class="form-group row">
                    <div class="col-sm-offset-2 col-sm-10 col-lg-6">
                        <div class="checkbox">
                            <label class="control-label">
                                <input ng-model='user.agreeToTaC' type="checkbox">
                                Agree to
                            </label>
                            <a href="{{admin.termsAndConditions}}">terms and conditions</a>.
                        </div>
                    </div>
                </div>
                <div ng-if="admin.enablePasswordReset" class="form-group row">
                    <div class="col-sm-offset-2 col-sm-10 col-lg-6">
                        <div class="checkbox">
                            <label class="control-label">
                                <input ng-model='user.enablePasswordReset' type="checkbox">
                                Enable Emailed Password Resets
                            </label>
                        </div>
                        <div ng-if="user.enablePasswordReset" class="alert alert-danger" role="alert">
                            <h6>
                                <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                                Allowing your password to be reset by email is discouraged since email communication
                                is not secure, and could allow un-authorized access to your account.
                                However, without this enabled your password cannot be reset if you forget it.
                            </h6>
                        </div>
                    </div>
                </div>
                <div class="form-group row">
                    <div class="col-sm-offset-2 col-sm-10 col-lg-6">
                        <button type="submit" class="btn btn-primary" ng-disabled="!allowRegister()">Register</button>
                    </div>
                </div>
                <div ng-if='error' class="form-group row">
                    <div class="col-sm-offset-2 col-sm-10 col-lg-6">
                        <div ng-include="'common.error'" ng-controller="common.error" onload="init(error)"><div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</script>

<script type="text/ng-template" id="/user.welcome.html">
    <div ng-if='!api.user._id'>
        <a ui-sref="user.register">Register</a>
        <a ui-sref="user.login">Login</a>
    </div>
    <div ng-if='api.user._id'>
        Welcome : <a ui-sref="user.controlPanel">{{api.isLoggedIn()}}</a>,
        <a ng-click="logout()" style="cursor: pointer;">Logout</a>
    </div>
</script>
